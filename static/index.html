<ul id="postList"></ul>

<script>
    async function loadPosts() {
        const res = await fetch("/api/posts");
        const data = await res.json();
        const ul = document.getElementById("postList");
        ul.innerHTML = "";
        for (const post of data) {
            const li = document.createElement("li");
            li.textContent = `${post.name}: ${post.message}`;
            ul.appendChild(li);
        }
    }

    document
        .getElementById("postForm")
        .addEventListener("submit", async function (e) {
            e.preventDefault();
            const form = new FormData(e.target);
            const res = await fetch("/api/post", {
                method: "POST",
                body: form,
            });
            const text = await res.text();
            document.getElementById("response").textContent = text;
            await loadPosts(); // ← 送信後に投稿一覧を更新
        });

    loadPosts(); // 初期表示
</script>
